<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Contest Details - SkillPort Admin</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>
  <style>
    body { font-family: 'Inter', sans-serif; }
  </style>
</head>
<body class="bg-gradient-to-br from-slate-50 via-white to-blue-50 min-h-screen">
  <!-- Navbar -->
  <nav class="sticky top-0 z-50 bg-white/80 backdrop-blur-xl border-b border-slate-200/50 shadow-sm">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between items-center h-16">
        <div class="flex items-center gap-2 group">
          <div class="w-8 h-8 bg-gradient-to-br from-red-600 to-pink-600 rounded-lg flex items-center justify-center group-hover:scale-105 transition-transform">
            <i data-lucide="shield" class="w-5 h-5 text-white"></i>
          </div>
          <span class="text-xl font-bold bg-gradient-to-r from-slate-900 to-slate-600 bg-clip-text text-transparent">
            SkillPort Admin
          </span>
        </div>
        <div class="hidden md:flex items-center gap-1">
          <a href="admin-dashboard.html" class="flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium text-slate-600 hover:text-slate-900 hover:bg-slate-50">
            <i data-lucide="layout-dashboard" class="w-4 h-4"></i> Dashboard
          </a>
          <a href="admin-users.html" class="flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium text-slate-600 hover:text-slate-900 hover:bg-slate-50">
            <i data-lucide="users" class="w-4 h-4"></i> Users
          </a>
          <a href="admin-communities.html" class="flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium text-slate-600 hover:text-slate-900 hover:bg-slate-50">
            <i data-lucide="users-2" class="w-4 h-4"></i> Communities
          </a>
          <a href="admin-contests.html" class="flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium bg-red-50 text-red-700 shadow-sm">
            <i data-lucide="trophy" class="w-4 h-4"></i> Contests
          </a>
          <a href="admin-analytics.html" class="flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium text-slate-600 hover:text-slate-900 hover:bg-slate-50">
            <i data-lucide="bar-chart-3" class="w-4 h-4"></i> Analytics
          </a>
          <a href="admin-leaderboard.html" class="flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium text-slate-600 hover:text-slate-900 hover:bg-slate-50">
            <i data-lucide="award" class="w-4 h-4"></i> Leaderboard
          </a>
          <a href="admin-settings.html" class="flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium text-slate-600 hover:text-slate-900 hover:bg-slate-50">
            <i data-lucide="settings" class="w-4 h-4"></i> Settings
          </a>
        </div>
        <!-- Admin Avatar -->
        <div class="relative">
          <img src="https://randomuser.me/api/portraits/men/1.jpg" alt="Admin Avatar" class="w-9 h-9 rounded-full object-cover border-2 border-red-200 cursor-pointer hover:border-red-300 transition-colors">
        </div>
      </div>
    </div>
  </nav>

  <!-- Main Content -->
  <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10">
    <!-- Loading State -->
    <div id="loading-state" class="text-center py-12">
      <div class="animate-spin w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full mx-auto mb-4"></div>
      <p class="text-slate-600">Loading contest details...</p>
    </div>

    <!-- Contest Content (hidden until loaded) -->
    <div id="contest-content" class="hidden">
      <div class="mb-8">
        <div class="flex items-center justify-between">
          <div>
            <h1 class="text-3xl font-bold text-slate-900 mb-2">Contest Details</h1>
            <p class="text-lg text-slate-600">Manage contest information, participants, and performance.</p>
          </div>
          <div class="flex gap-3">
            <button onclick="adminContestDetails.editContest()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors">
              <i data-lucide="edit" class="w-4 h-4 inline mr-2"></i> Edit Contest
            </button>
            <button onclick="adminContestDetails.deleteContest()" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors">
              <i data-lucide="trash-2" class="w-4 h-4 inline mr-2"></i> Delete Contest
            </button>
          </div>
        </div>
      </div>

      <!-- Contest Overview -->
      <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8">
        <!-- Contest Info -->
        <div class="lg:col-span-2">
          <div class="bg-white rounded-lg shadow-lg p-6">
            <div class="flex items-center gap-4 mb-6">
              <div class="w-16 h-16 bg-gradient-to-br from-blue-500 to-cyan-500 rounded-lg flex items-center justify-center">
                <i data-lucide="target" class="w-8 h-8 text-white"></i>
              </div>
              <div>
                <h2 class="text-2xl font-bold text-slate-900" id="contest-name">-</h2>
                <p class="text-slate-600" id="contest-description">-</p>
              </div>
              <span class="px-3 py-1 rounded-full text-sm font-medium" id="contest-status">-</span>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div>
                <h3 class="text-lg font-semibold text-slate-900 mb-4">Contest Information</h3>
                <div class="space-y-3">
                  <div class="flex justify-between">
                    <span class="text-slate-600">Category:</span>
                    <span class="font-medium text-slate-900" id="contest-category">-</span>
                  </div>
                  <div class="flex justify-between">
                    <span class="text-slate-600">Difficulty:</span>
                    <span class="font-medium text-slate-900" id="contest-difficulty">-</span>
                  </div>
                  <div class="flex justify-between">
                    <span class="text-slate-600">Start Date:</span>
                    <span class="font-medium text-slate-900" id="contest-start-date">-</span>
                  </div>
                  <div class="flex justify-between">
                    <span class="text-slate-600">End Date:</span>
                    <span class="font-medium text-slate-900" id="contest-end-date">-</span>
                  </div>
                  <div class="flex justify-between">
                    <span class="text-slate-600">Duration:</span>
                    <span class="font-medium text-slate-900" id="contest-duration">-</span>
                  </div>
                  <div class="flex justify-between">
                    <span class="text-slate-600">Max Participants:</span>
                    <span class="font-medium text-slate-900" id="contest-max-participants">-</span>
                  </div>
                </div>
              </div>
              
              <div>
                <h3 class="text-lg font-semibold text-slate-900 mb-4">Performance Metrics</h3>
                <div class="space-y-3">
                  <div class="flex justify-between">
                    <span class="text-slate-600">Total Participants:</span>
                    <span class="font-medium text-slate-900" id="total-participants">-</span>
                  </div>
                  <div class="flex justify-between">
                    <span class="text-slate-600">Problems Solved:</span>
                    <span class="font-medium text-slate-900" id="problems-solved">-</span>
                  </div>
                  <div class="flex justify-between">
                    <span class="text-slate-600">Average Score:</span>
                    <span class="font-medium text-slate-900" id="average-score">-</span>
                  </div>
                  <div class="flex justify-between">
                    <span class="text-slate-600">Completion Rate:</span>
                    <span class="font-medium text-slate-900" id="completion-rate">-</span>
                  </div>
                  <div class="flex justify-between">
                    <span class="text-slate-600">Time Remaining:</span>
                    <span class="font-medium text-amber-600" id="time-remaining">-</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Contest Stats -->
        <div class="space-y-6">
          <div class="bg-white rounded-lg shadow-lg p-6">
            <h3 class="text-lg font-semibold text-slate-900 mb-4">Quick Stats</h3>
            <div class="space-y-4">
              <div class="text-center">
                <div class="text-2xl font-bold text-blue-600" id="active-participants">-</div>
                <div class="text-sm text-slate-600">Active Participants</div>
              </div>
              <div class="text-center">
                <div class="text-2xl font-bold text-green-600" id="submissions-today">-</div>
                <div class="text-sm text-slate-600">Submissions Today</div>
              </div>
              <div class="text-center">
                <div class="text-2xl font-bold text-amber-600" id="avg-completion-time">-</div>
                <div class="text-sm text-slate-600">Avg Completion Time</div>
              </div>
            </div>
          </div>

          <div class="bg-white rounded-lg shadow-lg p-6">
            <h3 class="text-lg font-semibold text-slate-900 mb-4">Actions</h3>
            <div class="space-y-3">
              <button onclick="adminContestDetails.pauseContest()" class="w-full bg-amber-600 text-white px-4 py-2 rounded-lg hover:bg-amber-700 transition-colors">
                <i data-lucide="pause" class="w-4 h-4 inline mr-2"></i> Pause Contest
              </button>
              <button onclick="adminContestDetails.extendContest()" class="w-full bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors">
                <i data-lucide="clock" class="w-4 h-4 inline mr-2"></i> Extend Time
              </button>
              <button onclick="adminContestDetails.sendAnnouncement()" class="w-full bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors">
                <i data-lucide="megaphone" class="w-4 h-4 inline mr-2"></i> Send Announcement
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Participants Section -->
      <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
        <div class="flex items-center justify-between mb-6">
          <h2 class="text-xl font-bold text-slate-900">Participants</h2>
          <div class="flex gap-2">
            <input type="text" id="search-participants" placeholder="Search participants..." class="px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
            <select id="filter-participants" class="px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
              <option value="">All Status</option>
              <option value="active">Active</option>
              <option value="completed">Completed</option>
              <option value="disqualified">Disqualified</option>
            </select>
          </div>
        </div>

        <div class="overflow-x-auto">
          <table class="w-full">
            <thead>
              <tr class="border-b border-slate-200">
                <th class="text-left py-3 px-4 font-semibold text-slate-900">Participant</th>
                <th class="text-left py-3 px-4 font-semibold text-slate-900">Score</th>
                <th class="text-left py-3 px-4 font-semibold text-slate-900">Problems Solved</th>
                <th class="text-left py-3 px-4 font-semibold text-slate-900">Time Taken</th>
                <th class="text-left py-3 px-4 font-semibold text-slate-900">Status</th>
                <th class="text-left py-3 px-4 font-semibold text-slate-900">Actions</th>
              </tr>
            </thead>
            <tbody id="participants-table-body">
              <!-- Participants will be loaded here -->
            </tbody>
          </table>
        </div>

        <!-- Pagination -->
        <div class="flex items-center justify-between mt-6">
          <div class="text-sm text-slate-600">
            Showing <span id="showing-start">-</span> to <span id="showing-end">-</span> of <span id="total-participants-count">-</span> participants
          </div>
          <div class="flex gap-2">
            <button id="prev-page" class="px-3 py-2 border border-slate-300 rounded-lg hover:bg-slate-50 disabled:opacity-50 disabled:cursor-not-allowed">
              Previous
            </button>
            <button id="next-page" class="px-3 py-2 border border-slate-300 rounded-lg hover:bg-slate-50 disabled:opacity-50 disabled:cursor-not-allowed">
              Next
            </button>
          </div>
        </div>
      </div>

      <!-- Problems Section -->
      <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
        <h2 class="text-xl font-bold text-slate-900 mb-6">Contest Problems</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="problems-grid">
          <!-- Problems will be loaded here -->
        </div>
      </div>

      <!-- Recent Submissions -->
      <div class="bg-white rounded-lg shadow-lg p-6">
        <h2 class="text-xl font-bold text-slate-900 mb-6">Recent Submissions</h2>
        <div class="space-y-4" id="recent-submissions">
          <!-- Submissions will be loaded here -->
        </div>
      </div>
    </div>

    <!-- Empty State -->
    <div id="empty-state" class="text-center py-12 hidden">
      <i data-lucide="trophy" class="w-16 h-16 mx-auto mb-4 text-slate-400"></i>
      <h3 class="text-lg font-semibold text-slate-900 mb-2">Contest not found</h3>
      <p class="text-slate-600 mb-4">The requested contest could not be found or you don't have permission to view it</p>
      <a href="admin-contests.html" class="bg-blue-600 text-white px-6 py-2 rounded-lg font-semibold hover:bg-blue-700 transition-colors">
        Back to Contests
      </a>
    </div>
  </main>

  <!-- Load API and App scripts -->
  <script src="../../js/api.js"></script>
  <script src="../../js/app.js"></script>
  
  <script>
    lucide.createIcons();
    
    // Admin Contest Details Controller
    class AdminContestDetails {
      constructor() {
        this.api = window.SkillPortAPI;
        this.contest = null;
        this.participants = [];
        this.problems = [];
        this.submissions = [];
        this.currentPage = 1;
        this.participantsPerPage = 10;
        this.contestId = this.getContestIdFromUrl();
        this.init();
      }

      getContestIdFromUrl() {
        const urlParams = new URLSearchParams(window.location.search);
        return urlParams.get('id');
      }

      async init() {
        try {
          // Check if user is admin
          if (!this.api.isAuthenticated() || !this.api.isAdmin()) {
            window.location.href = '../../index.html';
            return;
          }

          if (!this.contestId) {
            this.showEmptyState();
            return;
          }

          // Load contest data
          await this.loadContestDetails();
          await this.loadParticipants();
          await this.loadProblems();
          await this.loadRecentSubmissions();
          
        } catch (error) {
          console.error('Contest details initialization failed:', error);
          this.showError('Failed to initialize contest details page');
        }
      }

      async loadContestDetails() {
        try {
          const response = await this.api.getContestDetails(this.contestId);
          if (response.success) {
            this.contest = response.data.contest;
            this.displayContestDetails();
          } else {
            this.showEmptyState();
          }
        } catch (error) {
          console.error('Failed to load contest details:', error);
          this.showError('Failed to load contest details');
        }
      }

      async loadParticipants() {
        try {
          const response = await this.api.getContestParticipants(this.contestId, {
            page: this.currentPage,
            limit: this.participantsPerPage
          });

          if (response.success) {
            this.participants = response.data.participants;
            this.displayParticipants();
            this.updatePagination(response.data.total);
          }
        } catch (error) {
          console.error('Failed to load participants:', error);
        }
      }

      async loadProblems() {
        try {
          const response = await this.api.getContestProblems(this.contestId);
          if (response.success) {
            this.problems = response.data.problems;
            this.displayProblems();
          }
        } catch (error) {
          console.error('Failed to load problems:', error);
        }
      }

      async loadRecentSubmissions() {
        try {
          const response = await this.api.getContestSubmissions(this.contestId, { limit: 10 });
          if (response.success) {
            this.submissions = response.data.submissions;
            this.displayRecentSubmissions();
          }
        } catch (error) {
          console.error('Failed to load submissions:', error);
        }
      }

      displayContestDetails() {
        if (!this.contest) return;

        // Hide loading, show content
        document.getElementById('loading-state').classList.add('hidden');
        document.getElementById('contest-content').classList.remove('hidden');

        // Update contest information
        document.getElementById('contest-name').textContent = this.contest.name;
        document.getElementById('contest-description').textContent = this.contest.description;
        document.getElementById('contest-category').textContent = this.contest.category;
        document.getElementById('contest-difficulty').textContent = this.contest.difficulty;
        document.getElementById('contest-start-date').textContent = new Date(this.contest.startDate).toLocaleDateString();
        document.getElementById('contest-end-date').textContent = new Date(this.contest.endDate).toLocaleDateString();
        document.getElementById('contest-duration').textContent = this.formatDuration(this.contest.duration);
        document.getElementById('contest-max-participants').textContent = this.contest.maxParticipants || 'Unlimited';

        // Update status with appropriate styling
        const statusElement = document.getElementById('contest-status');
        statusElement.textContent = this.contest.status;
        statusElement.className = `px-3 py-1 rounded-full text-sm font-medium ${this.getStatusColor(this.contest.status)}`;

        // Update performance metrics
        document.getElementById('total-participants').textContent = this.contest.participantCount || 0;
        document.getElementById('problems-solved').textContent = this.contest.solvedProblems || 0;
        document.getElementById('average-score').textContent = this.contest.averageScore ? `${this.contest.averageScore.toFixed(1)}%` : '-';
        document.getElementById('completion-rate').textContent = this.contest.completionRate ? `${this.contest.completionRate.toFixed(1)}%` : '-';
        document.getElementById('time-remaining').textContent = this.getTimeRemaining(this.contest.endDate);

        // Update quick stats
        document.getElementById('active-participants').textContent = this.contest.activeParticipants || 0;
        document.getElementById('submissions-today').textContent = this.contest.submissionsToday || 0;
        document.getElementById('avg-completion-time').textContent = this.contest.avgCompletionTime ? `${this.contest.avgCompletionTime} min` : '-';
      }

      displayParticipants() {
        const tbody = document.getElementById('participants-table-body');
        
        if (!this.participants.length) {
          tbody.innerHTML = `
            <tr>
              <td colspan="6" class="text-center py-8 text-slate-500">No participants found</td>
            </tr>
          `;
          return;
        }

        tbody.innerHTML = this.participants.map(participant => `
          <tr class="border-b border-slate-100 hover:bg-slate-50">
            <td class="py-3 px-4">
              <div class="flex items-center gap-3">
                <img src="${participant.avatar || 'https://randomuser.me/api/portraits/lego/1.jpg'}" alt="Avatar" class="w-8 h-8 rounded-full">
                <div>
                  <div class="font-medium text-slate-900">${participant.name}</div>
                  <div class="text-sm text-slate-500">${participant.email}</div>
                </div>
              </div>
            </td>
            <td class="py-3 px-4">
              <span class="font-medium text-slate-900">${participant.score || 0}</span>
            </td>
            <td class="py-3 px-4">
              <span class="text-slate-600">${participant.problemsSolved || 0}/${participant.totalProblems || 0}</span>
            </td>
            <td class="py-3 px-4">
              <span class="text-slate-600">${this.formatDuration(participant.timeTaken)}</span>
            </td>
            <td class="py-3 px-4">
              <span class="px-2 py-1 text-xs font-medium rounded-full ${this.getParticipantStatusColor(participant.status)}">
                ${participant.status}
              </span>
            </td>
            <td class="py-3 px-4">
              <button onclick="adminContestDetails.viewParticipantDetails('${participant.id}')" class="text-blue-600 hover:text-blue-700 text-sm font-medium">
                View Details
              </button>
            </td>
          </tr>
        `).join('');
      }

      displayProblems() {
        const grid = document.getElementById('problems-grid');
        
        if (!this.problems.length) {
          grid.innerHTML = `
            <div class="col-span-full text-center py-8 text-slate-500">
              No problems found for this contest
            </div>
          `;
          return;
        }

        grid.innerHTML = this.problems.map(problem => `
          <div class="bg-slate-50 rounded-lg p-4">
            <div class="flex items-center justify-between mb-3">
              <h3 class="font-semibold text-slate-900">${problem.title}</h3>
              <span class="px-2 py-1 text-xs font-medium rounded-full ${this.getDifficultyColor(problem.difficulty)}">
                ${problem.difficulty}
              </span>
            </div>
            <p class="text-sm text-slate-600 mb-3">${problem.description}</p>
            <div class="flex items-center justify-between text-sm">
              <span class="text-slate-500">${problem.solvedCount || 0} solved</span>
              <span class="text-slate-500">${problem.submissionCount || 0} submissions</span>
            </div>
          </div>
        `).join('');
      }

      displayRecentSubmissions() {
        const container = document.getElementById('recent-submissions');
        
        if (!this.submissions.length) {
          container.innerHTML = `
            <div class="text-center py-8 text-slate-500">
              No recent submissions found
            </div>
          `;
          return;
        }

        container.innerHTML = this.submissions.map(submission => `
          <div class="flex items-center justify-between p-4 border border-slate-200 rounded-lg">
            <div class="flex items-center gap-3">
              <img src="${submission.user.avatar || 'https://randomuser.me/api/portraits/lego/1.jpg'}" alt="Avatar" class="w-8 h-8 rounded-full">
              <div>
                <div class="font-medium text-slate-900">${submission.user.name}</div>
                <div class="text-sm text-slate-500">${submission.problem.title}</div>
              </div>
            </div>
            <div class="flex items-center gap-4">
              <span class="text-sm text-slate-600">${new Date(submission.submittedAt).toLocaleTimeString()}</span>
              <span class="px-2 py-1 text-xs font-medium rounded-full ${this.getSubmissionStatusColor(submission.status)}">
                ${submission.status}
              </span>
              <span class="text-sm font-medium text-slate-900">${submission.score || 0}%</span>
            </div>
          </div>
        `).join('');
      }

      updatePagination(total) {
        const start = (this.currentPage - 1) * this.participantsPerPage + 1;
        const end = Math.min(this.currentPage * this.participantsPerPage, total);
        
        document.getElementById('showing-start').textContent = start;
        document.getElementById('showing-end').textContent = end;
        document.getElementById('total-participants-count').textContent = total;

        // Update button states
        document.getElementById('prev-page').disabled = this.currentPage === 1;
        document.getElementById('next-page').disabled = end >= total;

        // Add event listeners
        document.getElementById('prev-page').onclick = () => this.changePage(-1);
        document.getElementById('next-page').onclick = () => this.changePage(1);
      }

      async changePage(delta) {
        const newPage = this.currentPage + delta;
        if (newPage < 1) return;

        this.currentPage = newPage;
        await this.loadParticipants();
      }

      // Contest actions
      async editContest() {
        window.location.href = `admin-contest-edit.html?id=${this.contestId}`;
      }

      async deleteContest() {
        if (!confirm('Are you sure you want to delete this contest? This action cannot be undone.')) {
          return;
        }

        try {
          const response = await this.api.deleteContest(this.contestId);
          if (response.success) {
            this.showSuccess('Contest deleted successfully!');
            window.location.href = 'admin-contests.html';
          } else {
            this.showError(response.message || 'Failed to delete contest');
          }
        } catch (error) {
          console.error('Failed to delete contest:', error);
          this.showError('An error occurred while deleting the contest');
        }
      }

      async pauseContest() {
        try {
          const response = await this.api.pauseContest(this.contestId);
          if (response.success) {
            this.showSuccess('Contest paused successfully!');
            await this.loadContestDetails();
          } else {
            this.showError(response.message || 'Failed to pause contest');
          }
        } catch (error) {
          console.error('Failed to pause contest:', error);
          this.showError('An error occurred while pausing the contest');
        }
      }

      async extendContest() {
        const hours = prompt('Enter additional hours to extend the contest:');
        if (!hours || isNaN(hours)) return;

        try {
          const response = await this.api.extendContest(this.contestId, { hours: parseInt(hours) });
          if (response.success) {
            this.showSuccess(`Contest extended by ${hours} hours!`);
            await this.loadContestDetails();
          } else {
            this.showError(response.message || 'Failed to extend contest');
          }
        } catch (error) {
          console.error('Failed to extend contest:', error);
          this.showError('An error occurred while extending the contest');
        }
      }

      async sendAnnouncement() {
        const message = prompt('Enter announcement message:');
        if (!message) return;

        try {
          const response = await this.api.sendContestAnnouncement(this.contestId, { message });
          if (response.success) {
            this.showSuccess('Announcement sent successfully!');
          } else {
            this.showError(response.message || 'Failed to send announcement');
          }
        } catch (error) {
          console.error('Failed to send announcement:', error);
          this.showError('An error occurred while sending the announcement');
        }
      }

      viewParticipantDetails(participantId) {
        window.location.href = `admin-user-details.html?id=${participantId}&contest=${this.contestId}`;
      }

      // Utility functions
      formatDuration(minutes) {
        if (!minutes) return '-';
        const hours = Math.floor(minutes / 60);
        const mins = minutes % 60;
        if (hours > 0) {
          return `${hours}h ${mins}m`;
        }
        return `${mins}m`;
      }

      getTimeRemaining(endDate) {
        const now = new Date();
        const end = new Date(endDate);
        const diffTime = end - now;
        const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
        
        if (diffDays <= 0) return 'Ended';
        if (diffDays === 1) return '1 day';
        if (diffDays < 7) return `${diffDays} days`;
        if (diffDays < 30) return `${Math.ceil(diffDays / 7)} weeks`;
        return `${Math.ceil(diffDays / 30)} months`;
      }

      getStatusColor(status) {
        const colors = {
          'active': 'bg-green-100 text-green-700',
          'paused': 'bg-amber-100 text-amber-700',
          'ended': 'bg-red-100 text-red-700',
          'upcoming': 'bg-blue-100 text-blue-700'
        };
        return colors[status] || 'bg-slate-100 text-slate-700';
      }

      getParticipantStatusColor(status) {
        const colors = {
          'active': 'bg-green-100 text-green-700',
          'completed': 'bg-blue-100 text-blue-700',
          'disqualified': 'bg-red-100 text-red-700'
        };
        return colors[status] || 'bg-slate-100 text-slate-700';
      }

      getDifficultyColor(difficulty) {
        const colors = {
          'easy': 'bg-green-100 text-green-700',
          'medium': 'bg-amber-100 text-amber-700',
          'hard': 'bg-red-100 text-red-700'
        };
        return colors[difficulty] || 'bg-slate-100 text-slate-700';
      }

      getSubmissionStatusColor(status) {
        const colors = {
          'accepted': 'bg-green-100 text-green-700',
          'wrong_answer': 'bg-red-100 text-red-700',
          'time_limit': 'bg-amber-100 text-amber-700',
          'runtime_error': 'bg-red-100 text-red-700'
        };
        return colors[status] || 'bg-slate-100 text-slate-700';
      }

      showEmptyState() {
        document.getElementById('loading-state').classList.add('hidden');
        document.getElementById('empty-state').classList.remove('hidden');
      }

      showSuccess(message) {
        if (this.api.showNotification) {
          this.api.showNotification(message, 'success');
        } else {
          alert(message);
        }
      }

      showError(message) {
        if (this.api.showNotification) {
          this.api.showNotification(message, 'error');
        } else {
          alert(message);
        }
      }
    }

    // Initialize when DOM is ready
    document.addEventListener('DOMContentLoaded', () => {
      window.adminContestDetails = new AdminContestDetails();
    });
  </script>
</body>
</html>

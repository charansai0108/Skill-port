<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mentor Feedback - PW IOI Community</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>
  <style>
    body { font-family: 'Inter', sans-serif; }
    
    /* Enhanced transitions and animations */
    .nav-link {
      transition: all 0.3s ease-in-out;
    }
    
    .nav-link:hover {
      background: rgba(255, 255, 255, 0.9);
      border-color: rgba(59, 130, 246, 0.3);
      box-shadow: 0 8px 32px rgba(31, 38, 135, 0.15);
      transform: translateY(-2px);
    }
    
    /* Enhanced glassy cards */
    .dashboard-card {
      transition: all 0.3s ease-in-out;
      backdrop-filter: blur(15px);
      background: rgba(255, 255, 255, 0.7);
      border: 1px solid rgba(255, 255, 255, 0.2);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }
    
    .dashboard-card:hover {
      background: rgba(255, 255, 255, 0.9);
      border-color: rgba(59, 130, 246, 0.4);
      box-shadow: 0 8px 24px rgba(31, 38, 135, 0.15);
      transform: translateY(-2px) scale(1.01);
    }

    /* Enhanced stat cards */
    .stat-card {
      transition: all 0.3s ease-in-out;
      animation: fadeInUp 0.3s ease-out;
      backdrop-filter: blur(15px);
      background: rgba(255, 255, 255, 0.65);
      border: 2px solid rgba(255, 255, 255, 0.6);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }
    
    .stat-card:hover {
      background: rgba(255, 255, 255, 0.85);
      border-color: rgba(59, 130, 246, 0.7);
      box-shadow: 0 8px 24px rgba(31, 38, 135, 0.2);
      transform: translateY(-2px) scale(1.02);
    }

    /* Enhanced feedback cards */
    .feedback-card {
      transition: all 0.3s ease-in-out;
      backdrop-filter: blur(15px);
      background: rgba(255, 255, 255, 0.8);
      border: 1px solid rgba(255, 255, 255, 0.3);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    }
    
    .feedback-card:hover {
      background: rgba(255, 255, 255, 0.95);
      border-color: rgba(59, 130, 246, 0.4);
      box-shadow: 0 8px 24px rgba(31, 38, 135, 0.15);
      transform: translateY(-2px) scale(1.01);
    }

    /* Enhanced button effects */
    .glass-btn {
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
    }
    
    .glass-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
    }

    /* Staggered animation delays */
    .stat-card:nth-child(1) { animation-delay: 0.05s; }
    .stat-card:nth-child(2) { animation-delay: 0.1s; }
    .stat-card:nth-child(3) { animation-delay: 0.15s; }
    .stat-card:nth-child(4) { animation-delay: 0.2s; }
    
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    .page-content {
      animation: slideIn 0.3s ease-out;
    }
    
    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateX(-20px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }
  </style>
</head>
<body class="bg-gradient-to-br from-slate-50 via-white to-blue-50 min-h-screen">
  <!-- Navbar -->
  <nav class="sticky top-0 z-30 bg-white/90 backdrop-blur-xl border-b border-slate-200/50 shadow-sm">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between items-center h-16">
        <div class="flex items-center gap-2 group">
          <div class="w-8 h-8 bg-gradient-to-br from-blue-600 to-indigo-600 rounded-lg flex items-center justify-center group-hover:scale-105 transition-transform">
            <i data-lucide="user" class="w-5 h-5 text-white"></i>
          </div>
          <span class="text-xl font-bold bg-gradient-to-r from-slate-900 to-slate-600 bg-clip-text text-transparent">
            <span id="navbar-student-name">Student</span>
          </span>
        </div>
        <div class="hidden md:flex items-center gap-1">
          <a href="user-dashboard.html" class="flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium text-slate-600 hover:text-slate-900 hover:bg-slate-50 transition-all">
            <i data-lucide="layout-dashboard" class="w-4 h-4"></i> Dashboard
          </a>
          <a href="user-contests.html" class="flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium text-slate-600 hover:text-slate-900 hover:bg-slate-50 transition-all">
            <i data-lucide="trophy" class="w-4 h-4"></i> Contests
          </a>
          <a href="user-leaderboard.html" class="flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium text-slate-600 hover:text-slate-900 hover:bg-slate-50 transition-all">
            <i data-lucide="award" class="w-4 h-4"></i> Leaderboard
          </a>
          <a href="user-mentor-feedback.html" class="flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium bg-blue-50 text-blue-700 shadow-sm">
            <i data-lucide="message-square" class="w-4 h-4"></i> Mentor Feedback
          </a>
          <a href="user-profile.html" class="flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium text-slate-600 hover:text-slate-900 hover:bg-slate-50 transition-all">
            <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=32&h=32&fit=crop&crop=face" alt="Profile" class="w-8 h-8 rounded-full object-cover shadow-lg border-2 border-white">
          </a>
        </div>
      </div>
    </div>
  </nav>

  <!-- Main Content -->
  <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10 page-content">
    <!-- Header -->
    <div class="mb-8">
      <div class="flex items-center gap-3 mb-4">
        <div class="w-10 h-10 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center shadow-lg">
          <i data-lucide="message-square" class="w-5 h-5 text-white"></i>
        </div>
      <div>
          <h1 class="text-2xl font-semibold text-slate-700">Mentor Feedback</h1>
          <p class="text-slate-600">Get personalized guidance and feedback from experienced mentors</p>
        </div>
      </div>
      <div class="flex justify-end">
        <button onclick="openRequestFeedbackModal()" class="glass-btn bg-blue-600/80 backdrop-blur-sm text-white px-6 py-3 rounded-lg hover:bg-blue-700/90 transition-all duration-300 hover:shadow-lg hover:-translate-y-1 border border-blue-500/20 flex items-center gap-2">
        <i data-lucide="message-plus" class="w-4 h-4"></i>
        Request Feedback
      </button>
      </div>
    </div>

    <!-- Feedback Stats -->
    <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
      <div class="stat-card bg-white rounded-xl shadow-lg p-6 border border-slate-100">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-sm font-medium text-slate-500">Total Feedback</h3>
          <div class="w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center">
            <i data-lucide="message-square" class="w-5 h-5 text-blue-600"></i>
          </div>
        </div>
        <div class="flex items-end gap-2">
          <span id="totalFeedback" class="text-3xl font-bold text-slate-900">18</span>
          <span class="text-sm text-slate-500 mb-1">reviews</span>
        </div>
      </div>

      <div class="stat-card bg-white rounded-xl shadow-lg p-6 border border-slate-100">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-sm font-medium text-slate-500">Average Rating</h3>
          <div class="w-10 h-10 rounded-full bg-amber-100 flex items-center justify-center">
            <i data-lucide="star" class="w-5 h-5 text-amber-600"></i>
          </div>
        </div>
        <div class="flex items-end gap-2">
          <span id="avgRating" class="text-3xl font-bold text-slate-900">4.7</span>
          <span class="text-sm text-slate-500 mb-1">/5</span>
        </div>
      </div>

      <div class="stat-card bg-white rounded-xl shadow-lg p-6 border border-slate-100">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-sm font-medium text-slate-500">Active Mentors</h3>
          <div class="w-10 h-10 rounded-full bg-green-100 flex items-center justify-center">
            <i data-lucide="users" class="w-5 h-5 text-green-600"></i>
          </div>
        </div>
        <div class="flex items-end gap-2">
          <span id="activeMentors" class="text-3xl font-bold text-slate-900">6</span>
          <span class="text-sm text-slate-500 mb-1">mentors</span>
        </div>
      </div>

      <div class="stat-card bg-white rounded-xl shadow-lg p-6 border border-slate-100">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-sm font-medium text-slate-500">This Month</h3>
          <div class="w-10 h-10 rounded-full bg-purple-100 flex items-center justify-center">
            <i data-lucide="calendar" class="w-5 h-5 text-purple-600"></i>
          </div>
        </div>
        <div class="flex items-end gap-2">
          <span id="monthlyFeedback" class="text-3xl font-bold text-slate-900">5</span>
          <span class="text-sm text-slate-500 mb-1">feedback</span>
        </div>
      </div>
    </div>

    <!-- Feedback Filters -->
    <div class="bg-white rounded-xl shadow-lg p-6 mb-8 border border-slate-100">
      <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
        <div>
          <label for="filterType" class="block text-sm font-medium text-slate-700 mb-2">Filter By Type</label>
          <select id="filterType" class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white">
            <option value="all">All Feedback</option>
            <option value="general">General Feedback</option>
            <option value="contest">Contest Feedback</option>
            <option value="code">Code Review</option>
            <option value="improvement">Improvement</option>
          </select>
        </div>
        <div>
          <label for="filterMentor" class="block text-sm font-medium text-slate-700 mb-2">Filter By Mentor</label>
          <select id="filterMentor" class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white">
            <option value="all">All Mentors</option>
            <option value="dr-sarah">Dr. Sarah Chen</option>
            <option value="prof-rajesh">Prof. Rajesh Sharma</option>
            <option value="amit-kumar">Amit Kumar</option>
            <option value="priya-patel">Priya Patel</option>
          </select>
        </div>
        <div>
          <label for="filterRating" class="block text-sm font-medium text-slate-700 mb-2">Filter By Rating</label>
          <select id="filterRating" class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white">
            <option value="all">All Ratings</option>
            <option value="5">5 Stars</option>
            <option value="4">4+ Stars</option>
            <option value="3">3+ Stars</option>
          </select>
        </div>
        <div>
          <label for="sortBy" class="block text-sm font-medium text-slate-700 mb-2">Sort By</label>
          <select id="sortBy" class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white">
            <option value="date-desc">Newest First</option>
            <option value="date-asc">Oldest First</option>
            <option value="rating-desc">Highest Rating</option>
            <option value="rating-asc">Lowest Rating</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Feedback List -->
    <div class="space-y-6" id="feedbackList">
      <!-- Feedback Item 1 -->
      <div class="feedback-card bg-white rounded-xl shadow-lg p-6 border border-slate-100">
        <div class="flex items-start justify-between mb-4">
          <div class="flex items-center gap-3">
            <div class="w-12 h-12 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-full flex items-center justify-center shadow-lg">
              <span class="text-lg font-bold text-white">S</span>
            </div>
            <div>
              <h3 class="text-lg font-semibold text-slate-900">Dr. Sarah Chen</h3>
              <p class="text-sm text-slate-600">Data Structures Expert • 2 days ago</p>
            </div>
          </div>
          <div class="flex items-center gap-1">
            <i data-lucide="star" class="w-4 h-4 text-yellow-400 fill-current"></i>
            <i data-lucide="star" class="w-4 h-4 text-yellow-400 fill-current"></i>
            <i data-lucide="star" class="w-4 h-4 text-yellow-400 fill-current"></i>
            <i data-lucide="star" class="w-4 h-4 text-yellow-400 fill-current"></i>
            <i data-lucide="star" class="w-4 h-4 text-yellow-400 fill-current"></i>
            <span class="ml-2 text-sm font-medium text-slate-700">5.0</span>
          </div>
        </div>
        <div class="mb-4">
          <span class="inline-flex px-3 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800 border border-blue-200">
            Code Review
          </span>
        </div>
        <p class="text-slate-700 mb-4 leading-relaxed">
          "Excellent work on the binary search tree implementation! Your code is well-structured and follows good practices. 
          The time complexity analysis is spot-on. Consider adding more edge case handling for better robustness."
        </p>
        <div class="flex items-center justify-between">
          <div class="text-sm text-slate-500">
            Related to: <span class="font-medium text-slate-700">Binary Search Tree Assignment</span>
          </div>
          <button onclick="openFeedbackDetailModal(1)" class="glass-btn bg-blue-600/80 backdrop-blur-sm text-white px-4 py-2 rounded-lg hover:bg-blue-700/90 transition-all duration-300 hover:shadow-lg hover:-translate-y-1 border border-blue-500/20">
            View Details
          </button>
        </div>
      </div>

      <!-- Feedback Item 2 -->
      <div class="feedback-card bg-white rounded-xl shadow-lg p-6 border border-slate-100">
        <div class="flex items-start justify-between mb-4">
          <div class="flex items-center gap-3">
            <div class="w-12 h-12 bg-gradient-to-br from-green-400 to-emerald-500 rounded-full flex items-center justify-center shadow-lg">
              <span class="text-lg font-bold text-white">R</span>
            </div>
            <div>
              <h3 class="text-lg font-semibold text-slate-900">Prof. Rajesh Sharma</h3>
              <p class="text-sm text-slate-600">Algorithms Specialist • 1 week ago</p>
            </div>
          </div>
          <div class="flex items-center gap-1">
            <i data-lucide="star" class="w-4 h-4 text-yellow-400 fill-current"></i>
            <i data-lucide="star" class="w-4 h-4 text-yellow-400 fill-current"></i>
            <i data-lucide="star" class="w-4 h-4 text-yellow-400 fill-current"></i>
            <i data-lucide="star" class="w-4 h-4 text-yellow-400 fill-current"></i>
            <i data-lucide="star" class="w-4 h-4 text-slate-300"></i>
            <span class="ml-2 text-sm font-medium text-slate-700">4.0</span>
          </div>
        </div>
        <div class="mb-4">
          <span class="inline-flex px-3 py-1 text-xs font-medium rounded-full bg-green-100 text-green-800 border border-green-200">
            Contest Feedback
          </span>
        </div>
        <p class="text-slate-700 mb-4 leading-relaxed">
          "Great performance in the weekly algorithm challenge! Your solution to the dynamic programming problem was elegant. 
          Work on optimizing space complexity - you can reduce it from O(n²) to O(n). Keep practicing!"
        </p>
        <div class="flex items-center justify-between">
          <div class="text-sm text-slate-500">
            Related to: <span class="font-medium text-slate-700">Weekly Algorithm Challenge</span>
          </div>
          <button onclick="openFeedbackDetailModal(2)" class="glass-btn bg-green-600/80 backdrop-blur-sm text-white px-4 py-2 rounded-lg hover:bg-green-700/90 transition-all duration-300 hover:shadow-lg hover:-translate-y-1 border border-green-500/20">
            View Details
          </button>
        </div>
      </div>

      <!-- Feedback Item 3 -->
      <div class="feedback-card bg-white rounded-xl shadow-lg p-6 border border-slate-100">
        <div class="flex items-start justify-between mb-4">
          <div class="flex items-center gap-3">
            <div class="w-12 h-12 bg-gradient-to-br from-purple-400 to-pink-500 rounded-full flex items-center justify-center shadow-lg">
              <span class="text-lg font-bold text-white">A</span>
            </div>
            <div>
              <h3 class="text-lg font-semibold text-slate-900">Amit Kumar</h3>
              <p class="text-sm text-slate-600">Web Development Mentor • 2 weeks ago</p>
            </div>
          </div>
          <div class="flex items-center gap-1">
            <i data-lucide="star" class="w-4 h-4 text-yellow-400 fill-current"></i>
            <i data-lucide="star" class="w-4 h-4 text-yellow-400 fill-current"></i>
            <i data-lucide="star" class="w-4 h-4 text-yellow-400 fill-current"></i>
            <i data-lucide="star" class="w-4 h-4 text-yellow-400 fill-current"></i>
            <i data-lucide="star" class="w-4 h-4 text-yellow-400 fill-current"></i>
            <span class="ml-2 text-sm font-medium text-slate-700">5.0</span>
          </div>
        </div>
        <div class="mb-4">
          <span class="inline-flex px-3 py-1 text-xs font-medium rounded-full bg-purple-100 text-purple-800 border border-purple-200">
            General Feedback
          </span>
        </div>
        <p class="text-slate-700 mb-4 leading-relaxed">
          "Your RESTful API design shows excellent understanding of HTTP principles and REST conventions. 
          The authentication implementation is solid. Consider adding rate limiting and input validation for production use."
        </p>
        <div class="flex items-center justify-between">
          <div class="text-sm text-slate-500">
            Related to: <span class="font-medium text-slate-700">API Development Project</span>
          </div>
          <button onclick="openFeedbackDetailModal(3)" class="glass-btn bg-purple-600/80 backdrop-blur-sm text-white px-4 py-2 rounded-lg hover:bg-purple-700/90 transition-all duration-300 hover:shadow-lg hover:-translate-y-1 border border-purple-500/20">
            View Details
          </button>
        </div>
    </div>

      <!-- Feedback Item 4 -->
      <div class="feedback-card bg-white rounded-xl shadow-lg p-6 border border-slate-100">
        <div class="flex items-start justify-between mb-4">
          <div class="flex items-center gap-3">
            <div class="w-12 h-12 bg-gradient-to-br from-orange-400 to-red-500 rounded-full flex items-center justify-center shadow-lg">
              <span class="text-lg font-bold text-white">P</span>
            </div>
            <div>
              <h3 class="text-lg font-semibold text-slate-900">Priya Patel</h3>
              <p class="text-sm text-slate-600">Database Expert • 3 weeks ago</p>
            </div>
          </div>
          <div class="flex items-center gap-1">
            <i data-lucide="star" class="w-4 h-4 text-yellow-400 fill-current"></i>
            <i data-lucide="star" class="w-4 h-4 text-yellow-400 fill-current"></i>
            <i data-lucide="star" class="w-4 h-4 text-yellow-400 fill-current"></i>
            <i data-lucide="star" class="w-4 h-4 text-yellow-400 fill-current"></i>
            <i data-lucide="star" class="w-4 h-4 text-slate-300"></i>
            <span class="ml-2 text-sm font-medium text-slate-700">4.0</span>
          </div>
        </div>
        <div class="mb-4">
          <span class="inline-flex px-3 py-1 text-xs font-medium rounded-full bg-orange-100 text-orange-800 border border-orange-200">
            Improvement
          </span>
        </div>
        <p class="text-slate-700 mb-4 leading-relaxed">
          "Good work on the database optimization project! Your query analysis skills are improving. 
          Focus on indexing strategies and consider using EXPLAIN plans more frequently. Great progress overall!"
        </p>
        <div class="flex items-center justify-between">
          <div class="text-sm text-slate-500">
            Related to: <span class="font-medium text-slate-700">Database Optimization</span>
          </div>
          <button onclick="openFeedbackDetailModal(4)" class="glass-btn bg-orange-600/80 backdrop-blur-sm text-white px-4 py-2 rounded-lg hover:bg-orange-700/90 transition-all duration-300 hover:shadow-lg hover:-translate-y-1 border border-orange-500/20">
            View Details
          </button>
        </div>
      </div>
    </div>

    <!-- Load More Button -->
    <div class="text-center mt-8">
      <button class="glass-btn bg-slate-600/80 backdrop-blur-sm text-white px-6 py-3 rounded-lg hover:bg-slate-700/90 transition-all duration-300 hover:shadow-lg hover:-translate-y-1 border border-slate-500/20">
        Load More Feedback
      </button>
    </div>
  </main>

  <!-- Request Feedback Modal -->
  <div id="requestFeedbackModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center hidden">
    <div class="bg-white rounded-xl shadow-xl p-6 max-w-lg w-full max-h-[90vh] overflow-y-auto">
      <div class="flex justify-between items-center mb-4">
        <h3 class="text-xl font-bold text-slate-900">Request Feedback from Mentor</h3>
        <button onclick="closeRequestFeedbackModal()" class="text-slate-500 hover:text-slate-700">
          <i data-lucide="x" class="w-5 h-5"></i>
        </button>
      </div>
      <form id="requestFeedbackForm">
        <div class="mb-4">
          <label class="block text-sm font-medium text-slate-700 mb-2">Select Mentor</label>
          <select class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white">
            <option>Dr. Sarah Chen</option>
            <option>Prof. Rajesh Sharma</option>
            <option>Amit Kumar</option>
            <option>Priya Patel</option>
            <option>Vikram Reddy</option>
          </select>
        </div>
        <div class="mb-4">
          <label class="block text-sm font-medium text-slate-700 mb-2">Feedback Type</label>
          <select id="requestFeedbackType" class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white">
            <option>General Feedback</option>
            <option>Code Review</option>
            <option>Performance Improvement</option>
            <option>Contest Feedback</option>
            <option>Task Feedback</option>
          </select>
        </div>
        <div id="requestContestSection" class="mb-4 hidden">
          <label class="block text-sm font-medium text-slate-700 mb-2">Select Contest</label>
          <select class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white">
            <option>Weekly Algorithm Challenge</option>
            <option>SQL Database Master</option>
            <option>Web Development Hackathon</option>
            <option>Python Programming Contest</option>
            <option>Java Coding Challenge</option>
          </select>
        </div>
        <div id="requestTaskSection" class="mb-4 hidden">
          <label class="block text-sm font-medium text-slate-700 mb-2">Select Task</label>
          <select class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white">
            <option>Binary Search Tree Implementation</option>
            <option>RESTful API Development</option>
            <option>Authentication System</option>
            <option>Database Query Optimization</option>
            <option>Responsive UI Design</option>
          </select>
        </div>
        <div class="mb-4">
          <label class="block text-sm font-medium text-slate-700 mb-2">Message</label>
          <textarea class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white" rows="4" placeholder="Describe what you'd like feedback on..."></textarea>
        </div>
        <div class="flex justify-end gap-3">
          <button type="button" onclick="closeRequestFeedbackModal()" class="px-4 py-2 border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 transition-colors">
            Cancel
          </button>
          <button type="submit" class="glass-btn bg-blue-600/80 backdrop-blur-sm text-white px-4 py-2 rounded-lg hover:bg-blue-700/90 transition-all duration-300 hover:shadow-lg hover:-translate-y-1 border border-blue-500/20">
            Submit Request
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Feedback Detail Modal -->
  <div id="feedbackDetailModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center hidden">
    <div class="bg-white rounded-xl shadow-xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto">
      <div class="flex justify-between items-center mb-4">
        <h3 id="modalTitle" class="text-xl font-bold text-slate-900">Feedback Details</h3>
        <button onclick="closeFeedbackDetailModal()" class="text-slate-500 hover:text-slate-700">
          <i data-lucide="x" class="w-5 h-5"></i>
        </button>
      </div>
      <div class="mb-4">
        <div class="flex items-center gap-3 mb-2">
          <div id="modalMentorAvatar" class="w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center">
            <i data-lucide="user" class="w-5 h-5 text-blue-600"></i>
          </div>
          <div>
            <p id="modalMentorName" class="text-sm font-medium text-slate-900">Mentor Name</p>
            <p id="modalDate" class="text-xs text-slate-500">Date</p>
          </div>
        </div>
        <div id="modalRating" class="flex items-center gap-1 mb-4">
          <!-- Stars will be populated here -->
        </div>
      </div>
      <div class="mb-6">
        <h4 class="text-sm font-medium text-slate-700 mb-2">Feedback</h4>
        <div id="modalContent" class="text-slate-600 bg-slate-50 rounded-lg p-4">
          <!-- Feedback content will be populated here -->
        </div>
      </div>
      <div id="modalRelatedSection" class="mb-6">
        <h4 class="text-sm font-medium text-slate-700 mb-2">Related To</h4>
        <div id="modalRelatedContent" class="text-slate-600 bg-slate-50 rounded-lg p-4">
          <!-- Related content will be populated here -->
        </div>
      </div>
      <div class="flex justify-end">
        <button onclick="closeFeedbackDetailModal()" class="glass-btn bg-slate-600/80 backdrop-blur-sm text-white px-4 py-2 rounded-lg hover:bg-slate-700/90 transition-all duration-300 hover:shadow-lg hover:-translate-y-1 border border-slate-500/20">
          Close
        </button>
      </div>
    </div>
  </div>

  <!-- Load API and App scripts -->
  <script src="../../js/apiService.js"></script>
  <script src="../js/api.js"></script>
  <script src="../js/app.js"></script>

  <script>
    // Initialize Lucide icons
    lucide.createIcons();
    
    // Dynamic feedback loading functionality
    async function loadUserFeedback() {
      try {
        console.log('Loading user feedback...');
        showFeedbackLoadingState();
        const response = await window.SkillPortAPI.getUserFeedback();
        if (response.success) {
          displayUserFeedback(response.data);
          updateFeedbackStats(response.data);
        } else {
          console.error('Failed to load feedback:', response.message);
          showStaticFeedback();
        }
      } catch (error) {
        console.error('Error loading feedback:', error);
        showStaticFeedback();
      }
    }

    function displayUserFeedback(feedbackList) {
      const feedbackListContainer = document.getElementById('feedbackList');
      if (!feedbackListContainer) return;

      if (feedbackList.length === 0) {
        feedbackListContainer.innerHTML = `
          <div class="text-center py-12">
            <div class="w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-4">
              <i data-lucide="message-square" class="w-8 h-8 text-slate-400"></i>
            </div>
            <h3 class="text-lg font-semibold text-slate-700 mb-2">No Feedback Yet</h3>
            <p class="text-slate-500">Request feedback from mentors to get started!</p>
          </div>
        `;
        lucide.createIcons();
        return;
      }

      feedbackListContainer.innerHTML = feedbackList.map(feedback => createFeedbackCard(feedback)).join('');
      lucide.createIcons();
    }

    function createFeedbackCard(feedback) {
      const typeColor = getTypeColor(feedback.type);
      const avatarColor = getAvatarColor(feedback.mentor.name);
      
      return `
        <div class="feedback-card bg-white rounded-xl shadow-lg p-6 border border-slate-100">
          <div class="flex items-start justify-between mb-4">
            <div class="flex items-center gap-3">
              <div class="w-12 h-12 bg-gradient-to-br ${avatarColor} rounded-full flex items-center justify-center shadow-lg">
                <span class="text-lg font-bold text-white">${feedback.mentor.name.charAt(0)}</span>
              </div>
              <div>
                <h3 class="text-lg font-semibold text-slate-900">${feedback.mentor.name}</h3>
                <p class="text-sm text-slate-600">${feedback.mentor.specialization} • ${formatDate(feedback.createdAt)}</p>
              </div>
            </div>
            <div class="flex items-center gap-1">
              ${generateStars(feedback.rating)}
              <span class="ml-2 text-sm font-medium text-slate-700">${feedback.rating}.0</span>
            </div>
          </div>
          <div class="mb-4">
            <span class="inline-flex px-3 py-1 text-xs font-medium rounded-full ${typeColor}">
              ${feedback.type}
            </span>
          </div>
          <p class="text-slate-700 mb-4 leading-relaxed">
            "${feedback.content}"
          </p>
          <div class="flex items-center justify-between">
            <div class="text-sm text-slate-500">
              Related to: <span class="font-medium text-slate-700">${feedback.relatedTo || 'General Feedback'}</span>
            </div>
            <button onclick="openFeedbackDetailModal('${feedback._id}')" class="glass-btn bg-blue-600/80 backdrop-blur-sm text-white px-4 py-2 rounded-lg hover:bg-blue-700/90 transition-all duration-300 hover:shadow-lg hover:-translate-y-1 border border-blue-500/20">
              View Details
            </button>
          </div>
        </div>
      `;
    }

    function updateFeedbackStats(feedbackList) {
      const totalFeedback = feedbackList.length;
      const avgRating = feedbackList.length > 0 
        ? (feedbackList.reduce((sum, f) => sum + f.rating, 0) / feedbackList.length).toFixed(1)
        : '0.0';
      const activeMentors = new Set(feedbackList.map(f => f.mentor._id)).size;
      const monthlyFeedback = feedbackList.filter(f => {
        const feedbackDate = new Date(f.createdAt);
        const now = new Date();
        return feedbackDate.getMonth() === now.getMonth() && feedbackDate.getFullYear() === now.getFullYear();
      }).length;

      document.getElementById('totalFeedback').textContent = totalFeedback;
      document.getElementById('avgRating').textContent = avgRating;
      document.getElementById('activeMentors').textContent = activeMentors;
      document.getElementById('monthlyFeedback').textContent = monthlyFeedback;
    }

    function showFeedbackLoadingState() {
      const feedbackListContainer = document.getElementById('feedbackList');
      if (!feedbackListContainer) return;
      feedbackListContainer.innerHTML = `
        <div class="text-center py-12">
          <div class="w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-4 animate-spin">
            <i data-lucide="loader-2" class="w-8 h-8 text-slate-400"></i>
          </div>
          <h3 class="text-lg font-semibold text-slate-700 mb-2">Loading Feedback...</h3>
          <p class="text-slate-500">Please wait while we fetch your feedback</p>
        </div>
      `;
      lucide.createIcons();
    }

    function showStaticFeedback() {
      // Keep existing static content as fallback
      console.log('Showing static feedback as fallback');
    }

    function getTypeColor(type) {
      switch(type) {
        case 'Code Review': return 'bg-blue-100 text-blue-800 border-blue-200';
        case 'Contest Feedback': return 'bg-green-100 text-green-800 border-green-200';
        case 'General Feedback': return 'bg-purple-100 text-purple-800 border-purple-200';
        case 'Improvement': return 'bg-orange-100 text-orange-800 border-orange-200';
        default: return 'bg-gray-100 text-gray-800 border-gray-200';
      }
    }

    function getAvatarColor(mentorName) {
      const colors = [
        'from-blue-400 to-indigo-500',
        'from-green-400 to-emerald-500',
        'from-purple-400 to-pink-500',
        'from-orange-400 to-red-500',
        'from-teal-400 to-cyan-500'
      ];
      const index = mentorName.charCodeAt(0) % colors.length;
      return colors[index];
    }

    function generateStars(rating) {
      let stars = '';
      for (let i = 1; i <= 5; i++) {
        const starClass = i <= rating ? 'text-yellow-400 fill-current' : 'text-slate-300';
        stars += `<i data-lucide="star" class="w-4 h-4 ${starClass}"></i>`;
      }
      return stars;
    }

    function formatDate(dateString) {
      const date = new Date(dateString);
      const now = new Date();
      const diffTime = Math.abs(now - date);
      const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
      
      if (diffDays === 1) return '1 day ago';
      if (diffDays < 7) return `${diffDays} days ago`;
      if (diffDays < 30) return `${Math.floor(diffDays / 7)} weeks ago`;
      return `${Math.floor(diffDays / 30)} months ago`;
    }
    
    // Sample feedback data for modal
    const feedbackData = {
      1: {
        title: "Code Review - Binary Search Tree",
        mentor: "Dr. Sarah Chen",
        avatar: "S",
        avatarColor: "from-blue-400 to-indigo-500",
        date: "2 days ago",
        rating: 5,
        type: "Code Review",
        typeColor: "bg-blue-100 text-blue-800 border-blue-200",
        content: "Excellent work on the binary search tree implementation! Your code is well-structured and follows good practices. The time complexity analysis is spot-on. Consider adding more edge case handling for better robustness. Your recursive approach is elegant and efficient. Keep up the great work!",
        related: "Binary Search Tree Assignment - Data Structures Course"
      },
      2: {
        title: "Contest Feedback - Algorithm Challenge",
        mentor: "Prof. Rajesh Sharma",
        avatar: "R",
        avatarColor: "from-green-400 to-emerald-500",
        date: "1 week ago",
        rating: 4,
        type: "Contest Feedback",
        typeColor: "bg-green-100 text-green-800 border-green-200",
        content: "Great performance in the weekly algorithm challenge! Your solution to the dynamic programming problem was elegant. Work on optimizing space complexity - you can reduce it from O(n²) to O(n). Keep practicing and you'll see significant improvements in your problem-solving skills.",
        related: "Weekly Algorithm Challenge - Week 12"
      },
      3: {
        title: "General Feedback - API Development",
        mentor: "Amit Kumar",
        avatar: "A",
        avatarColor: "from-purple-400 to-pink-500",
        date: "2 weeks ago",
        rating: 5,
        type: "General Feedback",
        typeColor: "bg-purple-100 text-purple-800 border-purple-200",
        content: "Your RESTful API design shows excellent understanding of HTTP principles and REST conventions. The authentication implementation is solid. Consider adding rate limiting and input validation for production use. Your code organization and documentation are exemplary.",
        related: "API Development Project - Web Development Course"
      },
      4: {
        title: "Improvement - Database Optimization",
        mentor: "Priya Patel",
        avatar: "P",
        avatarColor: "from-orange-400 to-red-500",
        date: "3 weeks ago",
        rating: 4,
        type: "Improvement",
        typeColor: "bg-orange-100 text-orange-800 border-orange-200",
        content: "Good work on the database optimization project! Your query analysis skills are improving. Focus on indexing strategies and consider using EXPLAIN plans more frequently. Great progress overall! Your understanding of normalization is solid.",
        related: "Database Optimization Project - Database Systems"
      }
    };
    
    // Request Feedback Modal Functions
    function openRequestFeedbackModal() {
      document.getElementById('requestFeedbackModal').classList.remove('hidden');
      document.body.style.overflow = 'hidden';
    }
    
    function closeRequestFeedbackModal() {
      document.getElementById('requestFeedbackModal').classList.add('hidden');
      document.body.style.overflow = 'auto';
      // Reset form
      document.getElementById('requestFeedbackForm').reset();
      document.getElementById('requestContestSection').classList.add('hidden');
      document.getElementById('requestTaskSection').classList.add('hidden');
    }
    
    // Feedback Detail Modal Functions
    function openFeedbackDetailModal(feedbackId) {
      const feedback = feedbackData[feedbackId];
      if (!feedback) return;

      // Populate modal content
      document.getElementById('modalTitle').textContent = feedback.title;
      document.getElementById('modalMentorName').textContent = feedback.mentor;
      document.getElementById('modalDate').textContent = feedback.date;
      document.getElementById('modalContent').textContent = feedback.content;
      document.getElementById('modalRelatedContent').textContent = feedback.related;

      // Update mentor avatar
      const avatarElement = document.getElementById('modalMentorAvatar');
      avatarElement.className = `w-10 h-10 rounded-full flex items-center justify-center shadow-lg bg-gradient-to-br ${feedback.avatarColor}`;
      avatarElement.innerHTML = `<span class="text-sm font-bold text-white">${feedback.avatar}</span>`;

      // Update rating stars
      const ratingElement = document.getElementById('modalRating');
      ratingElement.innerHTML = '';
      for (let i = 1; i <= 5; i++) {
        const star = document.createElement('i');
        star.className = `w-4 h-4 ${i <= feedback.rating ? 'text-yellow-400 fill-current' : 'text-slate-300'}`;
        star.setAttribute('data-lucide', 'star');
        ratingElement.appendChild(star);
      }
      lucide.createIcons();

      // Show modal
      document.getElementById('feedbackDetailModal').classList.remove('hidden');
      document.body.style.overflow = 'hidden';
    }
    
    function closeFeedbackDetailModal() {
      document.getElementById('feedbackDetailModal').classList.add('hidden');
      document.body.style.overflow = 'auto';
    }

    // Setup event listeners
    document.addEventListener('DOMContentLoaded', () => {
      // Set student name in navbar
      const studentNameElement = document.getElementById('navbar-student-name');
      if (studentNameElement) {
        studentNameElement.textContent = 'Alex Johnson';
      }
      
      // Load feedback dynamically
      loadUserFeedback();
      
      // Feedback type change for request form
      document.getElementById('requestFeedbackType')?.addEventListener('change', (e) => {
        const contestSection = document.getElementById('requestContestSection');
        const taskSection = document.getElementById('requestTaskSection');
        
        contestSection.classList.add('hidden');
        taskSection.classList.add('hidden');
        
        if (e.target.value === 'Contest Feedback') {
          contestSection.classList.remove('hidden');
        } else if (e.target.value === 'Task Feedback') {
          taskSection.classList.remove('hidden');
        }
      });
      
      // Request feedback form submission
      document.getElementById('requestFeedbackForm')?.addEventListener('submit', async (e) => {
        e.preventDefault();
        
        try {
          const formData = new FormData(e.target);
          const requestData = {
            mentorId: formData.get('mentor') || 'Dr. Sarah Chen',
            feedbackType: formData.get('feedbackType') || 'General Feedback',
            contestId: formData.get('contest') || null,
            taskId: formData.get('task') || null,
            message: formData.get('message') || ''
          };

          const response = await window.SkillPortAPI.requestFeedback(requestData);
          if (response.success) {
            alert('Feedback request submitted successfully!');
            closeRequestFeedbackModal();
          } else {
            alert('Failed to submit request: ' + response.message);
          }
        } catch (error) {
          console.error('Error submitting feedback request:', error);
          alert('Error submitting request. Please try again.');
        }
      });
    });
  </script>
</body>
</html>
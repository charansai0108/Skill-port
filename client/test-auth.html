<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auth Test</title>
    <script src="js/apiService.js"></script>
    <script src="js/authManager.js"></script>
</head>
<body>
    <h1>Authentication Test</h1>
    <div id="status">Loading...</div>
    <button onclick="testAuth()">Test Auth</button>
    <button onclick="testProfile()">Test Profile</button>
    <button onclick="clearToken()">Clear Token</button>
    
    <script>
        function testAuth() {
            console.log('Testing AuthManager...');
            console.log('Token:', localStorage.getItem('jwt_token'));
            console.log('AuthManager:', window.authManager);
            console.log('Is Authenticated:', window.authManager?.isAuthenticated);
            console.log('Current User:', window.authManager?.currentUser);
        }
        
        function testProfile() {
            console.log('Testing Profile API...');
            window.APIService.getUserProfile()
                .then(response => {
                    console.log('Profile Response:', response);
                    document.getElementById('status').innerHTML = 'Profile API: ' + JSON.stringify(response, null, 2);
                })
                .catch(error => {
                    console.error('Profile Error:', error);
                    document.getElementById('status').innerHTML = 'Profile Error: ' + error.message;
                });
        }
        
        function clearToken() {
            localStorage.removeItem('jwt_token');
            console.log('Token cleared');
            document.getElementById('status').innerHTML = 'Token cleared';
        }
        
        // Set a test token
        localStorage.setItem('jwt_token', 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4YjgyMDBlOTMzYTY3NDE4OTJkZGJiYiIsInJvbGUiOiJjb21tdW5pdHktYWRtaW4iLCJjb21tdW5pdHkiOiI2OGI4MjAwZTkzM2E2NzQxODkyZGRiYjkiLCJpYXQiOjE3NTY4OTg5OTksImV4cCI6MTc1NzUwMzc5OX0.4kb5O-yKC7YzEwf0mHMLTtWxB8Lym-94SkNepFqv7ww');
        
        document.addEventListener('DOMContentLoaded', () => {
            console.log('DOM loaded, testing auth...');
            testAuth();
        });
    </script>
</body>
</html>
